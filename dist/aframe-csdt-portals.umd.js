!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("yjs")):"function"==typeof define&&define.amd?define(["yjs"],t):t((e||self).yjs)}(this,function(e){function t(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var n=t(e);function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){var t,n;function r(t){var n;return(n=e.call(this)||this).iframe=t,n.ydoc.on("update",function(e,t,i,r){var o=new CustomEvent("CSDT-y-update",{detail:e});n.iframe.contentDocument.dispatchEvent(o)}),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var o=r.prototype;return o.checkSupport=function(){var e=this;return new Promise(function(t,n){window.document.addEventListener("CSDT-response-check-support",function(e){return t(e.detail)},{once:!0});var i=new CustomEvent("CSDT-check-support");e.iframe.contentDocument.dispatchEvent(i)})},o.openPortal=function(e,t){var n=this;return void 0===e&&(e=!1),void 0===t&&(t=!1),new Promise(function(i,r){window.document.addEventListener("CSDT-response-portal-open",function(e){return i(e.detail)},{once:!0});var o=new CustomEvent("CSDT-portal-open",{detail:{recievesThree:e,sendsThree:t}});n.iframe.contentDocument.dispatchEvent(o)})},r}(function(){var e=this;this.version="0.1.0",this.ydoc=new n.Doc,document.addEventListener("CSDT-y-update",function(t){n.applyUpdate(e.ydoc,t.detail)})});AFRAME.registerComponent("csdt-portal",{schema:{href:{default:""},title:{default:""},width:{default:1.5},height:{default:2.4},frameWidth:{default:.15},enableFrame:{default:!0}},init:function(){var e=this,t=this.el,n=this.data;n.siteSendsThree=!1,n.siteRecievesThree=!1,n.has_iframe_loaded=!1,t.object3D.position.y+=n.height/2;var i=document.createElement("a-text");if(i.setAttribute("value",n.title),i.setAttribute("position","0 "+(.5*n.height+.25+n.frameWidth)+" 0"),i.setAttribute("align","center"),i.setAttribute("side","double"),t.appendChild(i),1==n.enableFrame){var o=n.frameWidth,a=n.width,s=n.height,d=document.createElement("a-box");d.setAttribute("position",(a+o)/2+" 0 0"),d.setAttribute("scale",o+" "+s+" "+o),t.appendChild(d);var c=document.createElement("a-box");c.setAttribute("position",-(a+o)/2+" 0 0"),c.setAttribute("scale",o+" "+s+" "+o),t.appendChild(c);var u=document.createElement("a-box");u.setAttribute("position","0 "+(s+o)/2+" 0"),u.setAttribute("scale",a+2*o+" "+o+" "+o),t.appendChild(u);var l=document.createElement("a-box");l.setAttribute("position","0 0 "+(-o/4-.01)),l.setAttribute("scale",a+2*o+" "+(s+2*o)+" "+o/2),t.appendChild(l)}var h=document.createElement("iframe");h.src=n.url,document.body.appendChild(h),h.style.position="fixed",h.style.top="0",h.style.left="0",h.style.width="100%",h.style.height="100%",h.style.overflow="none",h.style.display="none",t.iframe=h,t.addEventListener("iframe loaded",function(){h.addEventListener("load",function(){var t=e.CSDT=new r(h);t.checkSupport().then(function(){t.openPortal(!0,!0,!0).then(function(e){console.log(e),1==e.sendsThree&&(n.siteSendsThree=!0),1==e.recievesThree&&(n.siteRecievesThree=!0)})})})})},tick:function(){var e=this.el,t=this.data;if(0==t.has_iframe_loaded&&e.websurface_iframe&&e.websurface_iframe.contentDocument&&(t.has_iframe_loaded=!0,e.emit("iframe loaded")),1==t.siteRecievesThree){var n=e.sceneEl.object3D.clone();n.children=n.children.filter(function(e){}),Math.random()>.99&&console.log(n.children)}}}),AFRAME.registerComponent("csdt-receiver-portal",{schema:{title:{default:"Return to Parent"},width:{default:1.5},height:{default:2.4},frameWidth:{default:.15},enableFrame:{default:!0}},init:function(){var e=window.CSDT,t=this.el,n=this.data;n.parentRecievesThree=!1,n.parentSendsThree=!1,t.object3D.position.y+=n.height/2;var i=document.createElement("a-text");if(i.setAttribute("value",n.title),i.setAttribute("position","0 "+(.5*n.height+.25+n.frameWidth)+" 0"),i.setAttribute("align","center"),i.setAttribute("side","double"),t.appendChild(i),1==n.enableFrame){var r=n.frameWidth,o=n.width,a=n.height,s=document.createElement("a-box");s.setAttribute("position",(o+r)/2+" 0 0"),s.setAttribute("scale",r+" "+a+" "+r),t.appendChild(s);var d=document.createElement("a-box");d.setAttribute("position",-(o+r)/2+" 0 0"),d.setAttribute("scale",r+" "+a+" "+r),t.appendChild(d);var c=document.createElement("a-box");c.setAttribute("position","0 "+(a+r)/2+" 0"),c.setAttribute("scale",o+2*r+" "+r+" "+r),t.appendChild(c);var u=document.createElement("a-box");u.setAttribute("position","0 0 "+(-r/4-.01)),u.setAttribute("scale",o+2*r+" "+(a+2*r)+" "+r/2),t.appendChild(u)}t.addEventListener("CSDT-portal-open",function(t){var i=t.detail;1==i.recievesThree&&(n.parentRecievesThree=!0),1==i.sendsThree&&(n.parentSendsThree=!0),e.responsePortalOpen(!0,!0,!0)})},tick:function(){if(1==this.data.parentRecievesThree){var e=this.el.sceneEl.object3D.clone();e.children=e.children.filter(function(e){})}}})});
//# sourceMappingURL=aframe-csdt-portals.umd.js.map
